<!-- Directory Table -->
<div class="card mb-3">
  <div class="card-body">
    <div class="table-responsive overflow-auto" style="max-height: 65vh">
      <table class="table table-hover table-striped align-middle">
        <thead class="table-light">
          <tr>
            <th style="width: 50px"></th>
            <th style="width: 35%">Name</th>
            <th style="width: 15%">Type</th>
            <th style="width: 15%">Size</th>
            <th style="width: 20%">Created</th>
            <th style="width: 15%">Permissions</th>
          </tr>
        </thead>
        <tbody>
          @for(item of items(); track item.path){
          <tr
            [class.table-info]="item.isDirectory"
            [class.text-muted]="item.error"
            [style.cursor]="item.isDirectory && !item.error ? 'pointer' : 'default'"
            (click)="updateDirectory(item)"
          >
            <!-- Icon -->
            <td class="text-center">
              @if (item.isDirectory) {
              <span class="badge bg-info fs-6"> üìÅ </span>
              } @else {
              <span class="badge bg-secondary fs-6"> üìÑ </span>
              }
            </td>

            <!-- Name -->
            <td>
              @if(item.isDirectory){
              <strong>{{ item.name }}</strong>
              } @else {
              <span>{{ item.name }}</span>
              } @if (item.error) {
              <small class="text-danger d-block">
                {{ item.error }}
              </small>
              }
            </td>

            <!-- Type/Extension -->
            <td>
              @if (item.isDirectory) {
              <span class="badge bg-info">Directory</span>
              } @else {
              <span class="badge bg-secondary">
                {{ item.extension }}
              </span>
              }
            </td>

            <!-- Size -->
            <td>
              @if(!item.isDirectory) {
              <span>{{ item.sizeFormatted }}</span>
              } @else {
              <span class="text-muted">-</span>
              }
            </td>

            <!-- Modified Date -->
            <td>
              @if (item.modifiedDate) {
              <small>{{ item.createdDate | date : 'short' }}</small>
              } @else {
              <small class="text-muted">-</small>
              }
            </td>

            <!-- Permissions -->
            <td>
              <div class="btn-group" role="group">
                <span
                  class="badge"
                  [class.bg-success]="item.permissions.readable"
                  [class.bg-secondary]="!item.permissions.readable"
                  title="Readable"
                >
                  R
                </span>
                <span
                  class="badge"
                  [class.bg-success]="item.permissions.writable"
                  [class.bg-secondary]="!item.permissions.writable"
                  title="Writable"
                >
                  W
                </span>
                <span
                  class="badge"
                  [class.bg-success]="item.permissions.executable"
                  [class.bg-secondary]="!item.permissions.executable"
                  title="Executable"
                >
                  X
                </span>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>

      <!-- <div *ngIf="data.items.length === 0" class="text-center py-5 text-muted">
        <p>This directory is empty</p>
      </div> -->
    </div>
  </div>
</div>
